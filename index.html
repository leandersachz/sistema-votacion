<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Votaci贸n</title>
    <link rel="manifest" href="manifest.json">
    
    <meta name="theme-color" content="#1a2a6c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sistema Votaci贸n">
    <link rel="stylesheet" href="style.css">
    <script src="pouchdb.min.js"></script>
    <script src="xlsx.full.min.js"></script>
    <script src="process.js"></script>
    <script src="registerWorker.js"></script>
</head>
<body>
    <div class="container">
        <!-- Pantalla de inicio -->
        <div id="login-screen" class="screen active">
            <h1>Sistema de Votaci贸n Segura</h1>
            <div class="instructions">
                <p>Para comenzar a votar, ingrese el c贸digo de acceso proporcionado por los organizadores.</p>
            </div>
            <!-- Eliminados los mensajes t茅cnicos -->
            <input type="password" id="access-code" placeholder="Ingrese el c贸digo de acceso">
            <button class="btn-primary" onclick="checkAccessCode()">Acceder para Votar</button>
            <button class="admin-btn" onclick="showAdminLogin()">Acceso Administrador</button>
        </div>
        
        <!-- Pantalla de selecci贸n de candidato -->
        <div id="voting-screen" class="screen">
            <h1>Seleccione su candidato</h1>
            <div id="candidates-list">
                <!-- Los candidatos se cargar谩n aqu铆 -->
            </div>
        </div>
        
        <!-- Pantalla de confirmaci贸n -->
        <div id="confirmation-screen" class="screen">
            <h1>Confirmar su voto</h1>
            <div id="selected-candidate-info"></div>
            <button class="btn-success" onclick="castVote()">Confirmar Voto</button>
            <button class="btn-secondary" onclick="goBackToVoting()">Cambiar Candidato</button>
        </div>
        
        <!-- Pantalla de bloqueo -->
        <div id="lock-screen" class="screen">
            <div class="locked-message">
                <h2>隆Su voto ha sido registrado!</h2>
                <p>La aplicaci贸n se ha bloqueado para garantizar la integridad del proceso electoral.</p>
                <p>Si necesita realizar otro voto autorizado, ingrese el c贸digo de acceso nuevamente.</p>
                <p>Gracias por participar.</p>
            </div>
            <button class="btn-primary" onclick="showLoginScreen()">Ingresar c贸digo para nuevo voto</button>
            <button class="admin-btn" onclick="showAdminLogin()">Acceso Administrador</button>
        </div>
        
        <!-- Pantalla de administrador -->
        <div id="admin-screen" class="screen">
            <h1>Panel de Administraci贸n</h1>
            <input type="password" id="admin-code" placeholder="C贸digo de administrador">
            <button class="btn-primary" onclick="checkAdminCode()">Acceder</button>
            <button class="btn-secondary" onclick="showLoginScreen()">Volver</button>
        </div>
        
        <!-- Pantalla de resultados -->
        <div id="results-screen" class="screen">
            <h1>Resultados de la Votaci贸n</h1>
            
            <!-- Eliminada la informaci贸n de almacenamiento -->
            
            <div class="export-options">
                <button class="btn-excel" onclick="exportToExcel()"> Exportar a Excel</button>
                <button class="btn-primary" onclick="exportToJSON()"> Exportar JSON</button>
            </div>
            
            <div id="results-container" class="results">
                <!-- Los resultados se cargar谩n aqu铆 -->
            </div>
            
            <div class="charts-container">
                <div class="chart-title">Distribuci贸n de Votos</div>
                <div class="chart-container" id="bar-chart">
                    <!-- Gr谩fico de barras se insertar谩 aqu铆 -->
                </div>
                
                <div class="chart-title">Resultados en Porcentajes</div>
                <div class="chart-container" id="pie-chart">
                    <!-- Gr谩fico circular se insertar谩 aqu铆 -->
                </div>
            </div>
            
            <div class="admin-panel">
                <h3>Opciones de Administrador</h3>
                <button class="btn-danger" onclick="confirmClearVotes()">Eliminar Todos los Votos</button>
                <button class="btn-secondary" onclick="resetVotingApp()">Reiniciar Aplicaci贸n</button>
                <!-- Eliminado el bot贸n de informaci贸n de base de datos -->
            </div>
            
            <button class="btn-secondary" onclick="showLoginScreen()">Volver al Inicio</button>
        </div>

        <!-- Modal de confirmaci贸n -->
        <div id="confirm-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
            <div style="background: white; padding: 30px; border-radius: 10px; text-align: center; max-width: 400px;">
                <h3 id="modal-title" style="margin-bottom: 15px;">驴Est谩 seguro?</h3>
                <p id="modal-message">Esta acci贸n no se puede deshacer.</p>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn-secondary" onclick="hideModal()">Cancelar</button>
                    <button class="btn-danger" id="modal-confirm-btn" onclick="modalConfirmAction()">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>